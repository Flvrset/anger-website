{%- if section.settings.end_date != blank -%}
  <div class="password-countdown-container">
    <div class="password-countdown">
      <div class="password-countdown__block">
        <span id="countdown-days" class="password-countdown__value">00</span>
        <span class="password-countdown__label">DAYS</span>
      </div>
      <span class="password-countdown__separator">:</span>
      <div class="password-countdown__block">
        <span id="countdown-hours" class="password-countdown__value">00</span>
        <span class="password-countdown__label">HOURS</span>
      </div>
      <span class="password-countdown__separator">:</span>
      <div class="password-countdown__block">
        <span id="countdown-minutes" class="password-countdown__value">00</span>
        <span class="password-countdown__label">MINUTES</span>
      </div>
      <span class="password-countdown__separator">:</span>
      <div class="password-countdown__block">
        <span id="countdown-seconds" class="password-countdown__value">00</span>
        <span class="password-countdown__label">SECONDS</span>
      </div>
    </div>
  </div>

  <script>
    const countdownDate = new Date({{ section.settings.end_date | json }}).getTime();
    const countdownContainer = document.querySelector('.password-countdown-container');
    const countdownStarted = false;

    const countdown = () => {
      const now = new Date().getTime();
      const distance = countdownDate - now;
      if (distance < 0) {
        clearInterval(countdownFunction);
        document.getElementById('countdown-days').innerText = '00';
        document.getElementById('countdown-hours').innerText = '00';
        document.getElementById('countdown-minutes').innerText = '00';
        document.getElementById('countdown-seconds').innerText = '00';
        return;
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      document.getElementById('countdown-days').innerText = String(days).padStart(2, '0');
      document.getElementById('countdown-hours').innerText = String(hours).padStart(2, '0');
      document.getElementById('countdown-minutes').innerText = String(minutes).padStart(2, '0');
      document.getElementById('countdown-seconds').innerText = String(seconds).padStart(2, '0');
    }
    countdown();
    setInterval(countdown, 1000);
  </script>
{%- endif -%}

<style>
  .password-countdown-container {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    opacity: 0.8;
    color: white;
    font-family: 'Anger', sans-serif;
    padding-top: 10vh;
  }
  .password-countdown {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }
  .password-countdown__block {
    display: flex;
    flex-direction: column;
  }
  .password-countdown__value {
    font-size: 4rem;
    font-weight: bold;
    line-height: 1;
  }
  .password-countdown__separator {
    font-size: 4rem;
    font-weight: bold;
    line-height: 1;
    padding-bottom: 3rem;
  }
  .password-countdown__label {
    font-size: 1.25rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }
  @media screen and (max-width: 600px) {
    .password-countdown__value {
      font-size: 3rem;
    }
    .password-countdown__label {
      font-size: 1rem;
    }

    .password-countdown__separator {
      padding-bottom: 2.5rem;
    }
    .password-countdown {
      gap: 0.5rem;
    }
  }
</style>

{% schema %}
{
  "name": "Password Countdown",
  "settings": [
    {
      "type": "text",
      "id": "end_date",
      "label": "Countdown end date",
      "info": "Format: YYYY-MM-DD HH:MM:SS"
    }
  ]
}
{% endschema %}
